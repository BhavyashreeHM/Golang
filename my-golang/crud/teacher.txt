package crud


func GetTeacherHandler(w http.ResponseWriter, r *http.Request) {

	// path := strings.TrimPrefix(r.URL.Path, "/teachers/")
	// idStr := strings.TrimSuffix(path, "/")
	// fmt.Println(idStr)

	parts := strings.Split(r.URL.Path, "/")
	var idStr string
	if len(parts) > 2 {
		idStr = parts[2]
	} else {
		idStr = ""
	}
	fmt.Println(idStr)

	firstname := r.URL.Query().Get("first_name")
	lastname := r.URL.Query().Get("last_name")

	teacherList := make([]models.Teacher, 0, len(teachers)) //teacherlist slice to hold teachers

	if idStr == "" {

		for _, teacher := range teachers {
			if (firstname == "" || teacher.FirstName == firstname) && (lastname == "" || teacher.LastName == lastname) {
				teacherList = append(teacherList, teacher)
			}
		}
		responce := struct {
			Status  string           `json:"status"`
			Message string           `json:"message"`
			Count   int              `json:"count"`
			Data    []models.Teacher `json:"data"`
		}{
			Status:  "success",
			Message: "Teacher retrieved successfully",
			Count:   len(teacherList),
			Data:    teacherList,
		}
		w.Header().Set("Content-Type", "application/json")
		json.NewEncoder(w).Encode(responce)

	}
	//Handle path parmeter id
	// id, err := strconv.Atoi(idStr)
	// if err != nil {
	// 	http.Error(w, "Invalid teacher ID", http.StatusBadRequest)
	// 	return
	// }
	// teacher, exists := teachers[id]
	// if !exists {
	// 	http.Error(w, "Teacher not found", http.StatusNotFound)
	// 	return
	// }
	w.Header().Set("Content-Type", "application/json")
	// json.NewEncoder(w).Encode(teacher)
}